.. highlight:: cl
   :linenothreshold: 0

Chapter 8 符號 (Symbols)
***************************************************

符號我們已經用了好長一段時間。蘊藏在符號背後還有更多。起初或許最好不要糾結背後的實現機制。你可以像資料物件與名字那樣使用符號，而不需要理解兩者是如何相關聯的。但到了某個時候，停下來並思考背後是如何動作的是很有用的。這個章節解釋了背後的細節。

8.1 符號名 (Symbol Names)
==================================

第二章描述符號是用來作為變數名並作為一個變數存在。但 Lisp 符號的可能性要比在多數語言僅允許作為變數名來得廣泛許多。實際上，一個符號可以用任何字串作為名稱。你可以透過呼叫 ``symbol-name`` 來獲得符號的名字：

::

	> (symbol-name 'abc)
	"ABC"

注意到這個符號的名字全部是大寫字母。預設情況下 Common Lisp 在讀入時，把符號名所有的英文字母都轉成大寫。這也表示了，Common Lisp 預設是不分大小寫的：

::

	> (eql 'abc 'Abc)
	T
	> (CaR '(a b c))
	A

有一個特殊的語法用來參照符號的名字，一些名字包含空白或其他可能對於讀取器 (reader)重要的字元。任何存在垂直槓 (vertical bar)之間的字元序列被視為一個符號。你可以這樣子在符號的名字中放入任何東西：

::

	> (list '|Lisp 1.5| '|| '|abc| '|ABC|)
	(|Lisp 1.5| || |abc| ABC)

當這樣的符號名讀入時，不會有大小寫轉換，而巨集字元和其他的字元被視為一般字元。

那什麼樣的符號不需要使用垂直槓來參照呢？基本上任何符號不是一個數字或不包含讀取器視為重要的字元。一個快速找出你是否可以不用垂直槓來參照符號的方法是看看 Lisp 如何印出它的。如果 Lisp 沒有用垂直槓表示一個符號，如上述列表的最後一個，那你也可以不用垂直槓。

記得垂直槓是一個特殊的語法來表示符號。它們不是符號的名字之一：

::

	> (symbol-name '|a b c|)
	"a b c"

(如果你想要在符號名使用垂直槓，你可以放一個反斜線在垂直槓的前面。)

譯註: 反斜線是 ``\`` 。

8.2 屬性列表 (Property Lists)
===============================

在 Common Lisp 裡，每一個符號都有一個屬性列表 (property-list) 或稱為 ``plist`` 。函數 ``get`` 接受一個符號及一個任何型別的鍵值，然後返回在符號的屬性列表中，與鍵值相關的數值：

::

	> (get 'alizarin 'color)
	NIL

它使用 ``eql`` 來比較各個鍵。若某個特定的屬性沒有找到時， ``get`` 返回 ``nil`` 。

要將一個值與一個鍵相關聯時，你可以使用 ``setf`` 及 ``get`` :

::

	> (setf (get 'alizarin 'color) 'red)
	RED
	> (get 'alizarin 'color)
	RED

現在符號 ``alizarin`` 的 ``color`` 屬性是 ``red`` 。

.. figure:: https://github.com/JuanitoFatas/acl-chinese/raw/master/images/Figure-8.1.png

**圖 8.1 符號的結構**

::

	> (setf (get 'alizarin 'transparency) 'high)
	HIGH
	> (symbol-plist 'alizarin)
	(TRANSPARENCY HIGH COLOR RED)

注意到屬性列表不以關聯列表 (assoc-lists)的形式表示，雖然他們用起來是一樣的。（譯註: 關聯列表在 3.14 節討論過）

在 Common Lisp 裡，屬性列表用得不多。他們大部分被雜湊表取代了 (4.8 小節)。

8.3 符號很不簡單 (Symbols Are Big)
================================

8.4 創造符號 (Creating Symbols)
===================================================

8.5 多重套件 (Multiple Packages)
=======================================

8.6 關鍵字 (Keywords)
=======================================

8.7 符號與變數 (Symbols and Variables)
=======================================

8.6 範例：隨機文字 (Example: Random Text)
=======================================

Chapter 8 總結 (Summary)
============================

Chapter 8 練習 (Exercises)
==================================